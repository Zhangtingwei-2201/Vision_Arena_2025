# 比赛阶段任务说明 (Level 1)

Level 1 共包含两个阶段任务，总分 **40分**（各阶段 20 分）。

## 评分标准

| 评分维度     | 分值 | 说明                                         |
| :----------- | :--- | :------------------------------------------- |
| **准确度**   | 15分 | 识别结果与真值的误差大小                     |
| **识别频率** | 5分  | 单位时间内有效识别的帧数（基于相机图像帧率） |
分别为准确度和识别频率的评分标准如下（得分为两部分加权）：
```
const std::array<std::pair<double, double>, 11> REVISED_FPS_SCORES = {{
    {40.0, 10.0},  // ≥40 FPS: 10分 (优秀)
    {35.0, 9.0},   // ≥35 FPS: 9分
    {30.0, 8.0},   // ≥30 FPS: 8分 (良好)
    {25.0, 7.0},   // ≥25 FPS: 7分
    {20.0, 6.0},   // ≥20 FPS: 6分 (中等)
    {15.0, 5.0},   // ≥15 FPS: 5分
    {12.0, 4.0},   // ≥12 FPS: 4分 (基础)
    {8.0, 3.0},    // ≥8 FPS: 3分
    {5.0, 2.0},    // ≥5 FPS: 2分
    {3.0, 1.0},    // ≥3 FPS: 1分
    {0.0, 0.0}     // <3 FPS: 0分
}};

const std::array<std::pair<double, double>, 11> REVISED_POSITION_SCORES = {{
    {0.1, 10.0},  // ≤0.1m: 10分 (优秀)
    {0.15, 9.0},  // ≤0.15m: 9分
    {0.2, 8.0},   // ≤0.2m: 8分 (良好)
    {0.3, 7.0},   // ≤0.3m: 7分
    {0.4, 6.0},   // ≤0.4m: 6分 (中等)
    {0.5, 5.0},   // ≤0.5m: 5分
    {0.6, 4.0},   // ≤0.6m: 4分 (基础)
    {0.8, 3.0},   // ≤0.8m: 3分
    {1.0, 2.0},   // ≤1.0m: 2分
    {1.5, 1.0},   // ≤1.5m: 1分
    {2.0, 0.0}    // >2.0m: 0分
}};
```
---
---

## 通用接口要求

所有阶段均需通过 ROS 2 话题发布识别结果。

- **话题名称**: `/vision/target`
- **消息类型**: `referee_pkg::msg::MultiObject`

### 消息字段说明

| 字段类型          | 字段名        | 说明                                            |
| :---------------- | :------------ | :---------------------------------------------- |
| `std_msgs/Header` | `header`      | **必须**与对应相机图像消息的时间戳保持一致      |
| `uint32`          | `num_objects` | 识别到的物体数量（需与 `objects` 数组长度一致） |
| `Object[]`        | `objects`     | 具体的物体信息数组                              |

---

## STAGE_1：圆环识别

本阶段目标是识别红色圆环（Ring_red）。为区分圆环与普通圆形，要求选手同时发布**外圆**和**内圆**的信息。

### 1. 识别要求
*   **目标物体**: 红色圆环 (`Ring_red`)
*   **发布数量**: `num_objects` 必须为 **2**。
*   **数组顺序**: `objects[0]` 为 **外圆**，`objects[1]` 为 **内圆**。

### 2. 关键点定义
每个圆需提供 **4个关键点**，顺序如下：
1.  **左点** (起始点)
2.  **下点**
3.  **右点**
4.  **上点**

> **注意**：点序必须为**逆时针**方向，且严格以**左点**开始。

---

## STAGE_2：箭头识别

本阶段目标是识别红色箭头（Arrow_red）。

### 1. 识别要求
*   **目标物体**: 红色箭头 (`Arrow_red`)
*   **发布数量**: `objects` 数组中必须包含类型为 `Arrow_red` 的对象，否则该帧得分为 0。

### 2. 关键点定义
箭头需提供 **4个角点**，顺序如下：
1.  **左上角** (起始点)
2.  **右上角**
3.  **右下角**
4.  **左下角**

> **注意**：点# 比赛阶段任务说明 (Level 1)

Level 1 共包含两个阶段任务，总分 **40分**（各阶段 20 分）。

## 评分标准

| 评分维度     | 分值 | 说明                                         |
| :----------- | :--- | :------------------------------------------- |
| **准确度**   | 15分 | 识别结果与真值的误差大小                     |
| **识别频率** | 5分  | 单位时间内有效识别的帧数（基于相机图像帧率） |

```
const std::array<std::pair<double, double>, 11> REVISED_FPS_SCORES = {{
    {40.0, 10.0},  // ≥40 FPS: 10分 (优秀)
    {35.0, 9.0},   // ≥35 FPS: 9分
    {30.0, 8.0},   // ≥30 FPS: 8分 (良好)
    {25.0, 7.0},   // ≥25 FPS: 7分
    {20.0, 6.0},   // ≥20 FPS: 6分 (中等)
    {15.0, 5.0},   // ≥15 FPS: 5分
    {12.0, 4.0},   // ≥12 FPS: 4分 (基础)
    {8.0, 3.0},    // ≥8 FPS: 3分
    {5.0, 2.0},    // ≥5 FPS: 2分
    {3.0, 1.0},    // ≥3 FPS: 1分
    {0.0, 0.0}     // <3 FPS: 0分
}};

const std::array<std::pair<double, double>, 11> REVISED_POSITION_SCORES = {{
    {0.1, 10.0},  // ≤0.1m: 10分 (优秀)
    {0.15, 9.0},  // ≤0.15m: 9分
    {0.2, 8.0},   // ≤0.2m: 8分 (良好)
    {0.3, 7.0},   // ≤0.3m: 7分
    {0.4, 6.0},   // ≤0.4m: 6分 (中等)
    {0.5, 5.0},   // ≤0.5m: 5分
    {0.6, 4.0},   // ≤0.6m: 4分 (基础)
    {0.8, 3.0},   // ≤0.8m: 3分
    {1.0, 2.0},   // ≤1.0m: 2分
    {1.5, 1.0},   // ≤1.5m: 1分
    {2.0, 0.0}    // >2.0m: 0分
}};
```
---

## 通用接口要求

所有阶段均需通过 ROS 2 话题发布识别结果。

- **话题名称**: `/vision/target`
- **消息类型**: `referee_pkg::msg::MultiObject`

### 消息字段说明

| 字段类型          | 字段名        | 说明                                            |
| :---------------- | :------------ | :---------------------------------------------- |
| `std_msgs/Header` | `header`      | **必须**与对应相机图像消息的时间戳保持一致      |
| `uint32`          | `num_objects` | 识别到的物体数量（需与 `objects` 数组长度一致） |
| `Object[]`        | `objects`     | 具体的物体信息数组                              |

---

## STAGE_1：圆环识别

本阶段目标是识别红色圆环（Ring_red）。为区分圆环与普通圆形，要求选手同时发布**外圆**和**内圆**的信息。

### 1. 识别要求
*   **目标物体**: 红色圆环 (`Ring_red`)
*   **发布数量**: `num_objects` 必须为 **2**。
*   **数组顺序**: `objects[0]` 为 **外圆**，`objects[1]` 为 **内圆**。

### 2. 关键点定义
每个圆需提供 **4个关键点**，顺序如下：
1.  **左点** (起始点)
2.  **下点**
3.  **右点**
4.  **上点**

> **注意**：点序必须为**逆时针**方向，且严格以**左点**开始。

---

## STAGE_2：箭头识别

本阶段目标是识别红色箭头（arrow）。

### 1. 识别要求
*   **目标物体**: 红色箭头 (`arrow`)
*   **发布数量**: `objects` 数组中必须包含类型为 `arrow` 的对象，否则该帧得分为 0。

### 2. 关键点定义
箭头需提供 **4个角点**，顺序如下：
1.  **左上角** (起始点)
2.  **右上角**
3.  **右下角**
4.  **左下角**

> **注意**：点序必须为顺时针方向，且严格以左上角开始。